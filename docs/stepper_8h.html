<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>gnea\grbl-Mega: stepper.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Grbl%20Logo%20250px[1].png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">gnea\grbl-Mega
   &#160;<span id="projectnumber">1.0f</span>
   </div>
   <div id="projectbrief">Source Code Documentation ( Internal Workings )</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('stepper_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">stepper.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="stepper_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab1187ab043fc8d02ac850cb535a905fb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper_8h.html#ab1187ab043fc8d02ac850cb535a905fb">SEGMENT_BUFFER_SIZE</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:ab1187ab043fc8d02ac850cb535a905fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aca75476034153603f1b4e76f9f2b7a72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper_8h.html#aca75476034153603f1b4e76f9f2b7a72">stepper_init</a> ()</td></tr>
<tr class="memdesc:aca75476034153603f1b4e76f9f2b7a72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize and setup the stepper motor subsystem.  <a href="#aca75476034153603f1b4e76f9f2b7a72">More...</a><br /></td></tr>
<tr class="separator:aca75476034153603f1b4e76f9f2b7a72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb4209518cbd433e7521435ce664c588"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper_8h.html#adb4209518cbd433e7521435ce664c588">st_wake_up</a> ()</td></tr>
<tr class="memdesc:adb4209518cbd433e7521435ce664c588"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable steppers, but cycle does not start unless called by motion control or realtime command.  <a href="#adb4209518cbd433e7521435ce664c588">More...</a><br /></td></tr>
<tr class="separator:adb4209518cbd433e7521435ce664c588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16251b4318ea2a3e12e1992edf43309f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper_8h.html#a16251b4318ea2a3e12e1992edf43309f">st_go_idle</a> ()</td></tr>
<tr class="memdesc:a16251b4318ea2a3e12e1992edf43309f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Immediately disables steppers.  <a href="#a16251b4318ea2a3e12e1992edf43309f">More...</a><br /></td></tr>
<tr class="separator:a16251b4318ea2a3e12e1992edf43309f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa05cd55b96bb4c27aab6158dc586e93c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper_8h.html#aa05cd55b96bb4c27aab6158dc586e93c">st_generate_step_dir_invert_masks</a> ()</td></tr>
<tr class="memdesc:aa05cd55b96bb4c27aab6158dc586e93c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate the step and direction port invert masks.  <a href="#aa05cd55b96bb4c27aab6158dc586e93c">More...</a><br /></td></tr>
<tr class="separator:aa05cd55b96bb4c27aab6158dc586e93c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fac3b6a1362ae6b3a738d99dfc56bce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper_8h.html#a3fac3b6a1362ae6b3a738d99dfc56bce">st_reset</a> ()</td></tr>
<tr class="memdesc:a3fac3b6a1362ae6b3a738d99dfc56bce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the stepper subsystem variables.  <a href="#a3fac3b6a1362ae6b3a738d99dfc56bce">More...</a><br /></td></tr>
<tr class="separator:a3fac3b6a1362ae6b3a738d99dfc56bce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4c1bb355a75a6d4b2d8cb8f4c17732b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper_8h.html#ac4c1bb355a75a6d4b2d8cb8f4c17732b">st_parking_setup_buffer</a> ()</td></tr>
<tr class="memdesc:ac4c1bb355a75a6d4b2d8cb8f4c17732b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Changes the run state of the step segment buffer to execute the special parking motion.  <a href="#ac4c1bb355a75a6d4b2d8cb8f4c17732b">More...</a><br /></td></tr>
<tr class="separator:ac4c1bb355a75a6d4b2d8cb8f4c17732b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a506e7fd929135772982ee840071ed7ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper_8h.html#a506e7fd929135772982ee840071ed7ee">st_parking_restore_buffer</a> ()</td></tr>
<tr class="memdesc:a506e7fd929135772982ee840071ed7ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restores the step segment buffer to the normal run state after a parking motion.  <a href="#a506e7fd929135772982ee840071ed7ee">More...</a><br /></td></tr>
<tr class="separator:a506e7fd929135772982ee840071ed7ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab85b0db8fab5c9398f1bef5c4bd3cf83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper_8h.html#ab85b0db8fab5c9398f1bef5c4bd3cf83">st_prep_buffer</a> ()</td></tr>
<tr class="memdesc:ab85b0db8fab5c9398f1bef5c4bd3cf83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reloads step segment buffer. Called continuously by realtime execution system.  <a href="#ab85b0db8fab5c9398f1bef5c4bd3cf83">More...</a><br /></td></tr>
<tr class="separator:ab85b0db8fab5c9398f1bef5c4bd3cf83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5da575c7645401c09b6df0a5a7f31082"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper_8h.html#a5da575c7645401c09b6df0a5a7f31082">st_update_plan_block_parameters</a> ()</td></tr>
<tr class="memdesc:a5da575c7645401c09b6df0a5a7f31082"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called by planner_recalculate() when the executing block is updated by the new plan.  <a href="#a5da575c7645401c09b6df0a5a7f31082">More...</a><br /></td></tr>
<tr class="separator:a5da575c7645401c09b6df0a5a7f31082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23af94f255d66e6503ad671e331eff52"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper_8h.html#a23af94f255d66e6503ad671e331eff52">st_get_realtime_rate</a> ()</td></tr>
<tr class="memdesc:a23af94f255d66e6503ad671e331eff52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called by realtime status reporting if realtime rate reporting is enabled in <a class="el" href="config_8h.html">config.h</a>.  <a href="#a23af94f255d66e6503ad671e331eff52">More...</a><br /></td></tr>
<tr class="separator:a23af94f255d66e6503ad671e331eff52"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ab1187ab043fc8d02ac850cb535a905fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEGMENT_BUFFER_SIZE&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stepper_8h_source.html#l00026">26</a> of file <a class="el" href="stepper_8h_source.html">stepper.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa05cd55b96bb4c27aab6158dc586e93c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void st_generate_step_dir_invert_masks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate the step and direction port invert masks. </p>
<p>Generate the step and direction port invert masks. </p>

<p>Definition at line <a class="el" href="stepper_8c_source.html#l00464">464</a> of file <a class="el" href="stepper_8c_source.html">stepper.c</a>.</p>

</div>
</div>
<a class="anchor" id="a23af94f255d66e6503ad671e331eff52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float st_get_realtime_rate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called by realtime status reporting if realtime rate reporting is enabled in <a class="el" href="config_8h.html">config.h</a>. </p>
<p>Called by realtime status reporting if realtime rate reporting is enabled in <a class="el" href="config_8h.html">config.h</a>. </p>

<p>Definition at line <a class="el" href="stepper_8c_source.html#l01001">1001</a> of file <a class="el" href="stepper_8c_source.html">stepper.c</a>.</p>

</div>
</div>
<a class="anchor" id="a16251b4318ea2a3e12e1992edf43309f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void st_go_idle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Immediately disables steppers. </p>
<p>Immediately disables steppers. </p>
<p>&lt; Disable Timer1 interrupt</p>
<p>&lt; Reset clock to no prescaling.</p>
<p>&lt; Keep enabled.</p>
<p>&lt; Override. Disable steppers. </p>

<p>Definition at line <a class="el" href="stepper_8c_source.html#l00224">224</a> of file <a class="el" href="stepper_8c_source.html">stepper.c</a>.</p>

</div>
</div>
<a class="anchor" id="a506e7fd929135772982ee840071ed7ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void st_parking_restore_buffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Restores the step segment buffer to the normal run state after a parking motion. </p>

</div>
</div>
<a class="anchor" id="ac4c1bb355a75a6d4b2d8cb8f4c17732b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void st_parking_setup_buffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Changes the run state of the step segment buffer to execute the special parking motion. </p>

</div>
</div>
<a class="anchor" id="ab85b0db8fab5c9398f1bef5c4bd3cf83"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void st_prep_buffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reloads step segment buffer. Called continuously by realtime execution system. </p>
<p>Reloads step segment buffer. Called continuously by realtime execution system.</p>
<p>The segment buffer is an intermediary buffer interface between the execution of steps by the stepper algorithm and the velocity profiles generated by the planner. The stepper algorithm only executes steps within the segment buffer and is filled by the main program when steps are "checked-out" from the first block in the planner buffer. This keeps the step execution and planning optimization processes atomic and protected from each other. The number of steps "checked-out" from the planner buffer and the number of segments in the segment buffer is sized and computed such that no operation in the main program takes longer than the time it takes the stepper algorithm to empty it before refilling it. Currently, the segment buffer conservatively holds roughly up to 40-50 msec of steps. </p><dl class="section note"><dt>Note</dt><dd>Computation units are in steps, millimeters, and minutes. </dd></dl>
<p>&lt; Check if we need to fill the buffer.</p>
<p>&lt; Reset for new segment block</p>
<p>&lt; Default velocity profile complete at 0.0mm from end of block.</p>
<p>&lt; [Forced Deceleration to Zero Velocity]</p>
<p>&lt; End of feed hold.</p>
<p>&lt; [Normal Operation]</p>
<p>&lt; Initialize as acceleration ramp.</p>
<p>&lt; Enforce stop at end of system motion.</p>
<p>&lt; Only occurs during override reductions.</p>
<p>&lt; Deceleration-only.</p>
<p>&lt; Flag to load next block as deceleration override.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>Determine correct handling of parameters in deceleration-only. </dd></dl>
<p>&lt; Either trapezoid or triangle types</p>
<p>&lt; Trapezoid type</p>
<p>&lt; Triangle type</p>
<p>&lt; Deceleration-only type</p>
<p>&lt; Acceleration-only type</p>
<p>&lt; Force update whenever updating block.</p>
<p>&lt; Maximum segment time</p>
<p>&lt; Initialize segment time</p>
<p>&lt; Time worker variable</p>
<p>&lt; mm-Distance worker variable</p>
<p>&lt; Speed worker variable</p>
<p>&lt; New segment distance from end of block.</p>
<p>&lt; Guarantee at least one step.</p>
<p>&lt; </p><dl class="section note"><dt>Note</dt><dd>0.0 at EOB</dd></dl>
<p>&lt; Mid-deceleration override ramp.</p>
<p>&lt; End of acceleration ramp.</p>
<p>&lt; </p><dl class="section note"><dt>Note</dt><dd>0.0 at EOB</dd></dl>
<p>&lt; Acceleration only.</p>
<p>&lt; End of cruise.</p>
<p>&lt; </p><dl class="section note"><dt>Note</dt><dd>0.0 at EOB</dd></dl>
<p>&lt; Cruising only.</p>
<p>&lt; case RAMP_DECEL:</p>
<p>&lt; Used as delta speed (mm/min)</p>
<p>&lt; Check if at or below zero speed.</p>
<p>&lt; (mm)</p>
<p>&lt; Typical case. In deceleration ramp.</p>
<p>&lt; Segment complete. Exit switch-case statement. Continue do-while loop.</p>
<p>&lt; Add computed ramp time to total segment time.</p>
<p>&lt; Check for very slow segments with zero steps.</p>
<p>&lt; <b>Complete</b> Exit loop. Segment execution time maxed.</p>
<p>&lt; <b>Complete</b> Exit loop. Profile complete.</p>
<p>&lt; Reload segment PWM value</p>
<p>&lt; Convert mm_remaining to steps</p>
<p>&lt; Round-up current steps remaining</p>
<p>&lt; Round-up last steps remaining</p>
<p>&lt; Compute number of steps to execute.</p>
<p>&lt; Segment not generated, but current step data still retained.</p>
<p>&lt; Apply previous segment partial step execute time</p>
<p>&lt; Compute adjusted step rate inverse</p>
<p>&lt; (cycles/step)</p>
<p>&lt; At end of forced-termination.</p>
<p>&lt; Bail!</p>
<p>&lt; End of planner block</p>
<p>&lt; Set pointer to indicate check and load next planner block. </p>

<p>Definition at line <a class="el" href="stepper_8c_source.html#l00594">594</a> of file <a class="el" href="stepper_8c_source.html">stepper.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3fac3b6a1362ae6b3a738d99dfc56bce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void st_reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the stepper subsystem variables. </p>
<p>Reset the stepper subsystem variables. </p>
<p>&lt; Planner block pointer used by segment buffer</p>
<p>&lt; empty = tail</p>
<p>&lt; Initialize direction bits to default. </p>

<p>Definition at line <a class="el" href="stepper_8c_source.html#l00476">476</a> of file <a class="el" href="stepper_8c_source.html">stepper.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5da575c7645401c09b6df0a5a7f31082"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void st_update_plan_block_parameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called by planner_recalculate() when the executing block is updated by the new plan. </p>
<p>&lt; Ignore if at start of a new block.</p>
<p>&lt; Update entry speed.</p>
<p>&lt; Flag st_prep_segment() to load and check active velocity profile. </p>

<p>Definition at line <a class="el" href="stepper_8c_source.html#l00526">526</a> of file <a class="el" href="stepper_8c_source.html">stepper.c</a>.</p>

</div>
</div>
<a class="anchor" id="adb4209518cbd433e7521435ce664c588"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void st_wake_up </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable steppers, but cycle does not start unless called by motion control or realtime command. </p>
<p>Enable steppers, but cycle does not start unless called by motion control or realtime command.</p>
<pre>
          __________________________
         /|                        |\     _________________         ^
        / |                        | \   /|               |\        |
       /  |                        |  \ / |               | \       s
      /   |                        |   |  |               |  \      p
     /    |                        |   |  |               |   \     e
    +-----+------------------------+---+--+---------------+----+    e
    |               BLOCK 1            ^      BLOCK 2          |    d
                                       |
                  time -----&gt;      EXAMPLE: Block 2 entry speed is at max junction velocity
</pre><p> The planner block buffer is planned assuming constant acceleration velocity profiles and are continuously joined at block junctions as shown above. However, the planner only actively computes the block entry speeds for an optimal velocity plan, but does not compute the block internal velocity profiles. These velocity profiles are computed ad-hoc as they are executed by the stepper algorithm and consists of only 7 possible types of profiles: cruise-only, cruise- deceleration, acceleration-cruise, acceleration-only, deceleration-only, full-trapezoid, and triangle(no cruise). </p><pre></pre><pre>                                        maximum_speed (&lt; nominal_speed) -&gt;  +
                    +--------+ &lt;- maximum_speed (= nominal_speed)          /|\
                   /          \                                           / | \
 current_speed -&gt; +            \                                         /  |  + &lt;- exit_speed
                  |             + &lt;- exit_speed                         /   |  |
                  +-------------+                     current_speed -&gt; +----+--+
                   time --&gt;  ^  ^                                           ^  ^
                             |  |                                           |  |
                decelerate_after(in mm)                             decelerate_after(in mm)
                    ^           ^                                           ^  ^
                    |           |                                           |  |
                accelerate_until(in mm)                             accelerate_until(in mm)
</pre><p> The step segment buffer computes the executing block velocity profile and tracks the critical parameters for the stepper algorithm to accurately trace the profile. These critical parameters are shown and defined in the above illustration.Stepper state initialization. Cycle should only start if the st.cycle_start flag is </p>
<p>&lt; Normal operation </p>

<p>Definition at line <a class="el" href="stepper_8c_source.html#l00199">199</a> of file <a class="el" href="stepper_8c_source.html">stepper.c</a>.</p>

</div>
</div>
<a class="anchor" id="aca75476034153603f1b4e76f9f2b7a72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stepper_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize and setup the stepper motor subsystem. </p>
<p>Initialize and setup the stepper motor subsystem. </p>
<p>&lt; waveform generation = 0100 = CTC</p>
<p>&lt; Disconnect OC1 output</p>
<p>&lt; Disconnect OC0 outputs and OVF interrupt.</p>
<p>&lt; Normal operation</p>
<p>&lt; Disable Timer0 until needed</p>
<p>&lt; Enable Timer0 overflow interrupt </p>

<p>Definition at line <a class="el" href="stepper_8c_source.html#l00500">500</a> of file <a class="el" href="stepper_8c_source.html">stepper.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_16af47fdf13b652490b4f721f0228326.html">grbl</a></li><li class="navelem"><a class="el" href="stepper_8h.html">stepper.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
