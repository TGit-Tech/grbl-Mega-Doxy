<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>gnea\grbl-Mega: planner.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Grbl%20Logo%20250px[1].png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">gnea\grbl-Mega
   &#160;<span id="projectnumber">1.0f</span>
   </div>
   <div id="projectbrief">Source Code Documentation ( Internal Workings )</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('planner_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">planner.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="grbl_8h_source.html">grbl.h</a>&quot;</code><br />
</div>
<p><a href="planner_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structplanner__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#structplanner__t">planner_t</a></td></tr>
<tr class="memdesc:structplanner__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define planner variables.  <a href="planner_8c.html#structplanner__t">More...</a><br /></td></tr>
<tr class="separator:structplanner__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acea0c9ce0566d9465bd51a9518ee065b"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#acea0c9ce0566d9465bd51a9518ee065b">plan_next_block_index</a> (uint8_t block_index)</td></tr>
<tr class="memdesc:acea0c9ce0566d9465bd51a9518ee065b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the index of the next block in the ring buffer. Also called by stepper segment buffer.  <a href="#acea0c9ce0566d9465bd51a9518ee065b">More...</a><br /></td></tr>
<tr class="separator:acea0c9ce0566d9465bd51a9518ee065b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada94abdd96ca26313d501f53867b89e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#ada94abdd96ca26313d501f53867b89e1">plan_reset</a> ()</td></tr>
<tr class="memdesc:ada94abdd96ca26313d501f53867b89e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize and reset the motion plan subsystem.  <a href="#ada94abdd96ca26313d501f53867b89e1">More...</a><br /></td></tr>
<tr class="separator:ada94abdd96ca26313d501f53867b89e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a455621828590a3de6c69f77c0217b24d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#a455621828590a3de6c69f77c0217b24d">plan_reset_buffer</a> ()</td></tr>
<tr class="memdesc:a455621828590a3de6c69f77c0217b24d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset buffer only.  <a href="#a455621828590a3de6c69f77c0217b24d">More...</a><br /></td></tr>
<tr class="separator:a455621828590a3de6c69f77c0217b24d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11e2f887e3c4818d23a617c8d0d25b1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#a11e2f887e3c4818d23a617c8d0d25b1f">plan_discard_current_block</a> ()</td></tr>
<tr class="memdesc:a11e2f887e3c4818d23a617c8d0d25b1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when the current block is no longer needed. Discards the block and makes the memory.  <a href="#a11e2f887e3c4818d23a617c8d0d25b1f">More...</a><br /></td></tr>
<tr class="separator:a11e2f887e3c4818d23a617c8d0d25b1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a693fe53a422f0ea77c219156fc60d5bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="planner_8h.html#structplan__block__t">plan_block_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#a693fe53a422f0ea77c219156fc60d5bd">plan_get_system_motion_block</a> ()</td></tr>
<tr class="memdesc:a693fe53a422f0ea77c219156fc60d5bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns address of planner buffer block used by system motions. Called by segment generator.  <a href="#a693fe53a422f0ea77c219156fc60d5bd">More...</a><br /></td></tr>
<tr class="separator:a693fe53a422f0ea77c219156fc60d5bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad73b13c6cb127ad1a00f1ab61179038c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="planner_8h.html#structplan__block__t">plan_block_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#ad73b13c6cb127ad1a00f1ab61179038c">plan_get_current_block</a> ()</td></tr>
<tr class="memdesc:ad73b13c6cb127ad1a00f1ab61179038c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns address of first planner block, if available. Called by various main program functions.  <a href="#ad73b13c6cb127ad1a00f1ab61179038c">More...</a><br /></td></tr>
<tr class="separator:ad73b13c6cb127ad1a00f1ab61179038c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d8671e3bec6e1c1081ca96253bd859e"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#a9d8671e3bec6e1c1081ca96253bd859e">plan_get_exec_block_exit_speed_sqr</a> ()</td></tr>
<tr class="memdesc:a9d8671e3bec6e1c1081ca96253bd859e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called by step segment buffer when computing executing block velocity profile.  <a href="#a9d8671e3bec6e1c1081ca96253bd859e">More...</a><br /></td></tr>
<tr class="separator:a9d8671e3bec6e1c1081ca96253bd859e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adae066f17807564d220e0c9007f6c49f"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#adae066f17807564d220e0c9007f6c49f">plan_check_full_buffer</a> ()</td></tr>
<tr class="memdesc:adae066f17807564d220e0c9007f6c49f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the availability status of the block ring buffer. True, if full.  <a href="#adae066f17807564d220e0c9007f6c49f">More...</a><br /></td></tr>
<tr class="separator:adae066f17807564d220e0c9007f6c49f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41fb2feb96bd8e3a126c8ba42e99ff26"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#a41fb2feb96bd8e3a126c8ba42e99ff26">plan_compute_profile_nominal_speed</a> (<a class="el" href="planner_8h.html#structplan__block__t">plan_block_t</a> *block)</td></tr>
<tr class="memdesc:a41fb2feb96bd8e3a126c8ba42e99ff26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes and returns block nominal speed based on running condition and override values.  <a href="#a41fb2feb96bd8e3a126c8ba42e99ff26">More...</a><br /></td></tr>
<tr class="separator:a41fb2feb96bd8e3a126c8ba42e99ff26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3ea51302ca691ccb21592cbc49f899d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#ac3ea51302ca691ccb21592cbc49f899d">plan_update_velocity_profile_parameters</a> ()</td></tr>
<tr class="memdesc:ac3ea51302ca691ccb21592cbc49f899d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-calculates buffered motions profile parameters upon a motion-based override change.  <a href="#ac3ea51302ca691ccb21592cbc49f899d">More...</a><br /></td></tr>
<tr class="separator:ac3ea51302ca691ccb21592cbc49f899d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca6bec963cb8abe980b0bd77fb70b2ff"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#aca6bec963cb8abe980b0bd77fb70b2ff">plan_buffer_line</a> (float *target, <a class="el" href="planner_8h.html#structplan__line__data__t">plan_line_data_t</a> *<a class="el" href="gcode_8c.html#a6a8a4abb31e881b8b50fe72bd8933073">pl_data</a>)</td></tr>
<tr class="memdesc:aca6bec963cb8abe980b0bd77fb70b2ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new linear movement to the buffer. target[N_AXIS] is the signed, absolute target position in millimeters. Feed rate specifies the speed of the motion. If feed rate is inverted, the feed rate is taken to mean "frequency" and would complete the operation in 1/feed_rate minutes. All position data passed to the planner must be in terms of machine position to keep the planner independent of any coordinate system changes and offsets, which are handled by the g-code parser.  <a href="#aca6bec963cb8abe980b0bd77fb70b2ff">More...</a><br /></td></tr>
<tr class="separator:aca6bec963cb8abe980b0bd77fb70b2ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33597329509a0f52f8591650509cdb7f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#a33597329509a0f52f8591650509cdb7f">plan_sync_position</a> ()</td></tr>
<tr class="memdesc:a33597329509a0f52f8591650509cdb7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the planner position vectors. Called by the system abort/initialization routine.  <a href="#a33597329509a0f52f8591650509cdb7f">More...</a><br /></td></tr>
<tr class="separator:a33597329509a0f52f8591650509cdb7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3411dbe393080d9b3ae84d267229d74"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#ab3411dbe393080d9b3ae84d267229d74">plan_get_block_buffer_available</a> ()</td></tr>
<tr class="memdesc:ab3411dbe393080d9b3ae84d267229d74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of available blocks are in the planner buffer.  <a href="#ab3411dbe393080d9b3ae84d267229d74">More...</a><br /></td></tr>
<tr class="separator:ab3411dbe393080d9b3ae84d267229d74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4833ae1fe25002abd406614615117863"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#a4833ae1fe25002abd406614615117863">plan_get_block_buffer_count</a> ()</td></tr>
<tr class="memdesc:a4833ae1fe25002abd406614615117863"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of active blocks are in the planner buffer.  <a href="#a4833ae1fe25002abd406614615117863">More...</a><br /></td></tr>
<tr class="separator:a4833ae1fe25002abd406614615117863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1371a85d6d5a5af249ecbe65ceb20d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planner_8c.html#aa1371a85d6d5a5af249ecbe65ceb20d5">plan_cycle_reinitialize</a> ()</td></tr>
<tr class="memdesc:aa1371a85d6d5a5af249ecbe65ceb20d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-initialize buffer plan with a partially completed block, assumed to exist at the buffer tail.  <a href="#aa1371a85d6d5a5af249ecbe65ceb20d5">More...</a><br /></td></tr>
<tr class="separator:aa1371a85d6d5a5af249ecbe65ceb20d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structplanner__t" id="structplanner__t"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct planner_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Define planner variables. </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00032">32</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="adc0ad1fc2ca3034c3faa01d06ef0e9fa"></a>int32_t</td>
<td class="fieldname">
position[<a class="el" href="nuts__bolts_8h.html#ad05168a527143ab187f87ef4d77ecdce">N_AXIS</a>]</td>
<td class="fielddoc">
The planner position of the tool in absolute steps. Kept separate. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ab2da456c92d50d3db602211d4fe9f494"></a>float</td>
<td class="fieldname">
previous_nominal_speed</td>
<td class="fielddoc">
Nominal speed of previous path line segment. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ae3b573b83e7f65fd73d587a281999b75"></a>float</td>
<td class="fieldname">
previous_unit_vec[<a class="el" href="nuts__bolts_8h.html#ad05168a527143ab187f87ef4d77ecdce">N_AXIS</a>]</td>
<td class="fielddoc">
Unit vector of previous path line segment. </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aca6bec963cb8abe980b0bd77fb70b2ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t plan_buffer_line </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="planner_8h.html#structplan__line__data__t">plan_line_data_t</a> *&#160;</td>
          <td class="paramname"><em>pl_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new linear movement to the buffer. target[N_AXIS] is the signed, absolute target position in millimeters. Feed rate specifies the speed of the motion. If feed rate is inverted, the feed rate is taken to mean "frequency" and would complete the operation in 1/feed_rate minutes. All position data passed to the planner must be in terms of machine position to keep the planner independent of any coordinate system changes and offsets, which are handled by the g-code parser. </p>
<p>Add a new linear movement to the buffer. target[N_AXIS] is the signed, absolute target position.</p>
<p>/ NOTE: Assumes buffer is available. Buffer checks are handled at a higher level by motion_control. In other words, the buffer head is never equal to the buffer tail. Also the feed rate input value is used in three ways: as a normal feed rate if invert_feed_rate is false, as inverse time if invert_feed_rate is true, or as seek/rapids rate if the feed_rate value is negative (and invert_feed_rate always false). The system motion condition tells the planner to plan a motion in the always unused block buffer head. It avoids changing the planner state and preserves the buffer to ensure subsequent gcode motions are still planned correctly, while the stepper module only points to the block buffer head to execute the special system motion. </p>
<p>&lt; Zero all block values.</p>
<p>NOTE: Computes true distance from converted step values.</p>
<p>&lt; Store unit vector numerator</p>
<p>NOTE: This calculation assumes all axes are orthogonal (Cartesian) and works with ABC-axes,</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>Need to check this method handling zero junction speeds when starting from rest. </dd></dl>
<p>&lt; Starting from rest. Enforce start from zero velocity.</p>
<p>NOTE: If the junction deviation value is finite, Grbl executes the motions in an exact path</p>
<p>NOTE: The max junction speed is a fixed value, since machine acceleration limits cannot be</p>
<p>NOTE: Computed without any expensive trig, sin() or acos(), by trig half angle identity of cos(theta).</p>
<p>&lt; Trig half angle identity. Always positive.</p>
<p>&lt; pl.previous_unit_vec[] = unit_vec[]</p>
<p>&lt; pl.position[] = target_steps[] </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00310">310</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="adae066f17807564d220e0c9007f6c49f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t plan_check_full_buffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the availability status of the block ring buffer. True, if full. </p>
<p>Returns the status of the block ring buffer. True, if buffer is full. </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00246">246</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="a41fb2feb96bd8e3a126c8ba42e99ff26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float plan_compute_profile_nominal_speed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="planner_8h.html#structplan__block__t">plan_block_t</a> *&#160;</td>
          <td class="paramname"><em>block</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes and returns block nominal speed based on running condition and override values. </p>
<p>Called by main program during planner calculations and step segment buffer during initialization.</p>
<p>NOTE: All system motion commands, such as homing/parking, are not subject to overrides. </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00255">255</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa1371a85d6d5a5af249ecbe65ceb20d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plan_cycle_reinitialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Re-initialize buffer plan with a partially completed block, assumed to exist at the buffer tail. </p>
<p>Reinitialize plan with a partially completed block. </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00509">509</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="a11e2f887e3c4818d23a617c8d0d25b1f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plan_discard_current_block </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when the current block is no longer needed. Discards the block and makes the memory. </p>
<p>&lt; Discard non-empty buffer. </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00214">214</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab3411dbe393080d9b3ae84d267229d74"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t plan_get_block_buffer_available </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the number of available blocks are in the planner buffer. </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00492">492</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4833ae1fe25002abd406614615117863"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t plan_get_block_buffer_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the number of active blocks are in the planner buffer. </p>
<p>NOTE: Deprecated. Not used unless classic status reports are enabled in <a class="el" href="config_8h.html">config.h</a> </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00501">501</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad73b13c6cb127ad1a00f1ab61179038c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="planner_8h.html#structplan__block__t">plan_block_t</a>* plan_get_current_block </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns address of first planner block, if available. Called by various main program functions. </p>
<p>Gets the current block. Returns NULL if buffer empty. </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00231">231</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="a9d8671e3bec6e1c1081ca96253bd859e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float plan_get_exec_block_exit_speed_sqr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called by step segment buffer when computing executing block velocity profile. </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00238">238</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="a693fe53a422f0ea77c219156fc60d5bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="planner_8h.html#structplan__block__t">plan_block_t</a>* plan_get_system_motion_block </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns address of planner buffer block used by system motions. Called by segment generator. </p>
<p>Gets the planner block for the special system motion cases. (Parking/Homing) </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00225">225</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="acea0c9ce0566d9465bd51a9518ee065b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t plan_next_block_index </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>block_index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the index of the next block in the ring buffer. Also called by stepper segment buffer. </p>
<p>Called periodically by step segment buffer. Mostly used internally by planner. </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00042">42</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="ada94abdd96ca26313d501f53867b89e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plan_reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize and reset the motion plan subsystem. </p>
<p>Reset all </p>
<p>&lt; Clear planner struct </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00198">198</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="a455621828590a3de6c69f77c0217b24d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plan_reset_buffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset buffer only. </p>
<p>&lt; Empty = tail</p>
<p>&lt; plan_next_block_index(block_buffer_head)</p>
<p>&lt; = block_buffer_tail; </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00205">205</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="a33597329509a0f52f8591650509cdb7f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plan_sync_position </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the planner position vectors. Called by the system abort/initialization routine. </p>
<p>Reset the planner position vector (in steps) </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd>For motor configurations not in the same coordinate frame as the machine position, </dd></dl>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00471">471</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac3ea51302ca691ccb21592cbc49f899d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plan_update_velocity_profile_parameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Re-calculates buffered motions profile parameters upon a motion-based override change. </p>
<p>&lt; Set high for first block nominal speed calculation.</p>
<p>&lt; Update prev nominal speed for next incoming block. </p>

<p>Definition at line <a class="el" href="planner_8c_source.html#l00278">278</a> of file <a class="el" href="planner_8c_source.html">planner.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_16af47fdf13b652490b4f721f0228326.html">grbl</a></li><li class="navelem"><a class="el" href="planner_8c.html">planner.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
